function colorize-log {
  colorize red ERROR | \
  colorize yellow 'WARN(ING)?' | \
  colorize green INFO | \
  colorize white DEBUG | \
  colorize white TRACE | \
  colorize red error | \
  colorize yellow 'warn(ing)?' | \
  colorize green info | \
  colorize white debug | \
  colorize white trace
}

function colorize {
  COLOR="$1"; shift
  ack --flush --passthru --color --color-match="$COLOR" $@
}

function aws-me {
  aws sts get-caller-identity | jq -r '.Account'
}

function passgen {
  openssl rand -base64 $1
}

function g-clean-sqaushed {
  TARGET_BRANCH=${1:-main} && git checkout -q $TARGET_BRANCH && git for-each-ref refs/heads/ "--format=%(refname:short)" | while read branch; do mergeBase=$(git merge-base $TARGET_BRANCH $branch) && [[ $(git cherry $TARGET_BRANCH $(git commit-tree $(git rev-parse $branch\^{tree}) -p $mergeBase -m _)) == "-"* ]] && git branch -D $branch; done
}

function g-clean-sqaushed-dry {
  TARGET_BRANCH=${1:-main} && git checkout -q $TARGET_BRANCH && git for-each-ref refs/heads/ "--format=%(refname:short)" | while read branch; do mergeBase=$(git merge-base $TARGET_BRANCH $branch) && [[ $(git cherry $TARGET_BRANCH $(git commit-tree $(git rev-parse $branch\^{tree}) -p $mergeBase -m _)) == "-"* ]] && echo "$branch is ready to be deleted"; done
}